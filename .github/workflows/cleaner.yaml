name: Actions Cleaner

# This is an experiment to see if we can get a better minimal container
# by removing a bunch of things we don't want.

on: 

  # On pull request we test updates to images
  pull_request: []
 
jobs:
  update:
    name: Clean All The Things!
    runs-on: ubuntu-latest
    steps:

      - name: Pre-Size
        run: df -h

      - name: Purge Docker
        run: |
           printf "docker system prune --all --force\n"
           docker system prune --all --force

      - name: Remove Big Installs
        run: |

          ls /opt
          ls /usr/share
          printf "sudo rm -rf /usr/share/dotnet\n"
          sudo rm -rf /usr/share/dotnet
          printf "sudo rm -rf /usr/local/lib/android\n"
          sudo rm -rf /usr/local/lib/android
          printf "sudo rm -rf /opt/ghc\n"
          sudo rm -rf /opt/ghc
          printf "sudo rm -rf /opt/az\n"
          sudo rm -rf /opt/az
          tree /opt
          tree /usr/share
          tree /

      - name: Post-Size
        run: df -h

